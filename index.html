<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <title>DDBP</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f4f8;
      height: 100%;
      overflow: hidden;
    }
    .table-container {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      padding: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid #ccc;
    }
    thead {
      background-color: #a3c4dc;
      position: sticky;
      top: 0;
      z-index: 2;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: center;
      white-space: nowrap;
    }
    th.name, td.name {
      text-align: left;
      white-space: normal;
    }
    .hidden-print {
      display: none;
    }
    tbody tr:hover {
      background-color: #eef4fa;
      cursor: pointer;
    }
    .home-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #a3c4dc;
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      z-index: 10;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.4);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    .modal-content h2 {
      margin-bottom: 15px;
      color: #333;
    }
    .modal-close {
      float: right;
      font-weight: bold;
      font-size: 22px;
      color: #888;
      cursor: pointer;
    }
    .modal-close:hover {
      color: #000;
    }
    .info-btn {
      position: fixed;
      bottom: 95px;
      right: 29px;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 50%;
      padding: 13px;
      font-size: 14px;
      cursor: #00000000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.5);
      z-index: 10;
    }
  </style>
</head>
<body>

  <div class="table-container" id="print-area">
    <table>
      <thead>
        <tr>
          <th>SI</th>
          <th class="hidden-print">Timestamp</th>
          <th class="name">‡¶®‡¶æ‡¶Æ</th>
          <th class="hidden-print">‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</th>
          <th>Tk</th>
        </tr>
      </thead>
      <tbody id="data-body"></tbody>
    </table>
  </div>

  <button class="home-btn" onclick="downloadTableAsPDF()">üìÇ</button>
  <button class="info-btn" onclick="showInfo()">üè∑Ô∏è</button>

  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" id="modalClose">&times;</span>
      <h2>‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</h2>
      <p id="modalTimestamp"></p>
      <p id="modalName"></p>
      <p id="modalFather"></p>
      <p id="modalTk"></p>
    </div>
  </div>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span class="modal-close" onclick="document.getElementById('infoModal').style.display='none'">&times;</span>
      <h2>‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá</h2>
      <p>‡¶è‡¶á ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶®‡ßá‡¶∞ ‡¶ü‡ßÅ‡¶≤, ‡¶Ø‡¶æ Realtime simulation ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡ßá‡•§ </p>
      <ul style="margin-top:10px; padding-left:20px;">
        <li>üìÑ ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°‡•§</li>
        <li>üì• PDF ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ‡•§</li>
        <li>üîç ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø Clickable row.</li>
 	<li>üõ°Ô∏è 2025, ROFIQUL</li>
	<li>üîí All Rights Preserved.</li>
      </ul><br>
      <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶Ø‡¶¶‡¶ø ‡¶§‡¶æ‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡¶ü‡¶ø ‡¶†‡¶ø‡¶ï‡¶Æ‡¶§ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶ø‡¶§ ‡¶®‡¶æ ‡¶π‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° (üìÇ) ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶∏‡¶ø‡¶Æ‡ßç‡¶™‡¶≤‡¶ø ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶°‡¶ï‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶è‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø PDF ‡¶ï‡¶™‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶®‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá <a href="https://wa.me/8801783983569?text=‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ!%20‡¶Ü‡¶Æ‡¶ø%20‡¶§‡ßã‡¶Æ‡¶æ‡¶∞%20‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü%20‡¶•‡ßá‡¶ï‡ßá%20‡¶Æ‡ßá‡¶∏‡ßá‡¶ú%20‡¶™‡¶æ‡¶†‡¶æ‡¶ö‡ßç‡¶õ‡¶ø‡•§" target="_blank">
  WhatsApp-‡¶è ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®</a></p>
    </div>
  </div>

  <script>
    const sheetURL = "https://opensheet.elk.sh/1aTSjXaYE7O6N3GteGhEtN_0qW3DGPsJFbFoTmrwoLf0/Form Responses 1";

    const modal = document.getElementById("myModal");
    const modalClose = document.getElementById("modalClose");
    const modalTimestamp = document.getElementById("modalTimestamp");
    const modalName = document.getElementById("modalName");
    const modalFather = document.getElementById("modalFather");
    const modalTk = document.getElementById("modalTk");

    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        const tby = document.getElementById("data-body");
        let total = 0;

        data.forEach((row, index) => {
          const tr = document.createElement("tr");

          const tdSerial = document.createElement("td");
          tdSerial.textContent = index + 1;
          tr.appendChild(tdSerial);

          const tdTimestamp = document.createElement("td");
          tdTimestamp.textContent = row["Timestamp"] || "";
          tdTimestamp.classList.add("hidden-print");
          tr.appendChild(tdTimestamp);

          const tdName = document.createElement("td");
          tdName.textContent = row["Name"] || "";
          tdName.classList.add("name");
          tr.appendChild(tdName);

          const tdFather = document.createElement("td");
          const fatherKey = Object.keys(row).find(key => key.toLowerCase().includes("father"));
          tdFather.textContent = fatherKey ? row[fatherKey] : "";
          tdFather.classList.add("hidden-print");
          tr.appendChild(tdFather);

          const tdTk = document.createElement("td");
          const tkAmount = parseFloat(row["Tk"]) || 0;
          tdTk.textContent = tkAmount.toFixed(2);
          tr.appendChild(tdTk);

          total += tkAmount;

          tr.addEventListener("click", () => {
            modalTimestamp.innerHTML = `‡¶∏‡¶Æ‡ßü‡¶É <span style="color:crimson; font-weight:bold;">${row["Timestamp"] || "N/A"}</span>`;
            modalName.innerHTML = `‡¶®‡¶æ‡¶Æ‡¶É <span style="color:darkblue; font-weight:bold;">${row["Name"] || "N/A"}</span>`;
            modalFather.innerHTML = `‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ‡¶É <span style="color:darkgreen; font-weight:bold;">${fatherKey ? row[fatherKey] : "N/A"}</span>`;
            modalTk.innerHTML = `‡¶ü‡¶æ‡¶ï‡¶æ‡¶É <span style="color:darkorange; font-weight:bold;">${tkAmount.toFixed(2)} ‡ß≥</span>`;
            modal.style.display = "flex";
          });

          tbody.appendChild(tr);
        });

        const totalRowScreen = createTotalRow(total, true);
        tbody.appendChild(totalRowScreen);

        const totalRowPDF = createTotalRow(total, false);
        totalRowPDF.classList.add("hidden-print");
        totalRowPDF.setAttribute("id", "pdf-total-row");
        tbody.appendChild(totalRowPDF);
      });

    function createTotalRow(total, isScreen) {
      const tr = document.createElement("tr");
      if (isScreen) {
        tr.innerHTML = `<td colspan="2" style="font-weight:bold; text-align:center;">‡¶Æ‡ßã‡¶ü</td>
                        <td colspan="2" class="hidden-print"></td>
                        <td style="font-weight:bold; color:green;">${total.toFixed(2)} ‡ß≥</td>`;
      } else {
        tr.innerHTML = `<td colspan="4" style="font-weight:bold; text-align:center;">‡¶Æ‡ßã‡¶ü</td>
                        <td style="font-weight:bold; color:green;">${total.toFixed(2)} ‡ß≥</td>`;
      }
      return tr;
    }

    modalClose.onclick = () => modal.style.display = "none";
    window.onclick = e => {
      if (e.target === modal) modal.style.display = "none";
    };

    function downloadTableAsPDF() {
      const hidden = document.querySelectorAll('.hidden-print');
      hidden.forEach(el => el.classList.remove('hidden-print'));

      const totalRowScreen = document.querySelector("tbody tr:nth-last-child(2)");
      if (totalRowScreen) totalRowScreen.style.display = "none";

      const totalRowPDF = document.getElementById("pdf-total-row");
      if (totalRowPDF) {
        totalRowPDF.classList.remove('hidden-print');
        totalRowPDF.style.display = "";
      }

      const opt = {
        margin: 0.2,
        filename: 'table-data.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };

      html2pdf().set(opt).from(document.getElementById("print-area")).save();

      setTimeout(() => {
        hidden.forEach(el => el.classList.add('hidden-print'));
        if (totalRowScreen) totalRowScreen.style.display = "";
        if (totalRowPDF) totalRowPDF.classList.add('hidden-print');
      }, 1000);
    }

    function showInfo() {
      document.getElementById('infoModal').style.display = 'flex';
    }
    window.onclick = function(e) {
      if (e.target === modal) {
        modal.style.display = "none";
      }
      if (e.target === document.getElementById("infoModal")) {
        document.getElementById("infoModal").style.display = "none";
      }
    };
  </script>
</body>
</html>
